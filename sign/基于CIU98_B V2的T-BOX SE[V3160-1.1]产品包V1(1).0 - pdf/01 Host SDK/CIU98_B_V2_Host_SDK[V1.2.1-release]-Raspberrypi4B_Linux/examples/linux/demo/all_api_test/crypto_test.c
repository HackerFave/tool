/**@file  crypto_test.c
* @brief  crypto_test interface declearation	 
* @author liangww
* @date  2021-05-28
* @version	V1.0
* @copyright  Copyright(C),CEC Huada Electronic Design Co.,Ltd.
*/

/***************************************************************************
* Include Header Files
***************************************************************************/
#include "crypto_test.h"



/** @addtogroup SE_APP_TEST
  * @{
  */


/** @defgroup CRYPTO_TEST CRYPTO_TEST
  * @brief crypto_test interface api.
  * @{
  */

/* Exported functions --------------------------------------------------------*/
/** @defgroup CPYPTO_Exported_Functions CPYPTO Exported Functions
  * @{
  */

/**
* @brief 对称算法、非对称算法和哈希等示例
* @param no
* @return 参见error.h
* @note no
* @see 函数asym_test sym_test digest_test 
*/
se_error_t crypto_test(void)
{
	se_error_t ret = 0;
	
	

    ret = sym_test();
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to sym_test!\n");
		return ret;
	} 



	ret = asym_test();
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to asym_test!\n");
		return ret;
	}

	
	ret = digest_test();
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to digest_test!\n");
		return ret;
	}  	

	
	
	return SE_SUCCESS;
}

/**
* @brief 哈希计算示例
* @param no
* @return 参见error.h
* @note no
* @see 函数api_digest 
*/
se_error_t digest_test(void)
{
	se_error_t ret = 0;
	uint8_t init_input[50] = {0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00};	
	uint8_t in_buf[CRYPTO_DATA_SIZE]={0};
	uint32_t in_buf_len = 32;
	uint32_t in_len = 0;
	uint8_t out_buf[60] = {0};
	uint32_t out_buf_len= 0;
	uint32_t i = 0;
	uint32_t alg =ALG_SHA256;
	char s_refer_buf[CRYPTO_DATA_SIZE*2] = {0};
	uint32_t s_refer_buf_len= 0;
	uint8_t refer_buf[CRYPTO_DATA_SIZE] = {0};
	//uint32_t refer_buf_len= 0;
	

    //设置输入数据，可以根据i值控制输入长度
	while(i<10)
	{
		memcpy(in_buf+i*in_buf_len,init_input,in_buf_len);
		i++;
	}
	//SHA256参考数据
	//64字节："A736658535B4D40B023E5137A958B5E3CB9CDE5A4F8A816A5F8D77A9D939A2CC"
	//254字节："6E7F43391211407D790A7F5F0A22A21F6F97D0E62EC9B3C07F57EC7AA5AD7421"
	//300字节："5A100E2C47E810EE55666EC5F623D224481115DC6EE4827DB3E3879F0D28851F"
	//600字节："D320BDEB12F2B5610A3C88D0A1877ABA28A2728C3857FB0B1C77E33EF498A2E8"

	//SM3参考数据
	//64字节："AB747EF76DBD4C9297462F0F2291D06DC9ED99F4703B91FE5516080E257A8AFD"
	//254字节："223E903473A88C57D921B30757D3A47F63D5A6D5247DFC615EE232EE2E5CFC11"
	//300字节："986A47D839824E1D4F4AA632FABA7830F7B649B9B3307028FD7BAD287E940592"
	//600字节："767AA81EFC8A973B402841B021A219715C3CB5006E079BE608C576BB8C3AD593"

	//哈希方式为SHA256
	alg = ALG_SHA256;
	strcpy(s_refer_buf,"A736658535B4D40B023E5137A958B5E3CB9CDE5A4F8A816A5F8D77A9D939A2CC");
	
	
	//哈希方式为SM3
	alg = ALG_SM3;
	strcpy(s_refer_buf,"223E903473A88C57D921B30757D3A47F63D5A6D5247DFC615EE232EE2E5CFC11");
	s_refer_buf_len = 64;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	//refer_buf_len = s_refer_buf_len/2;

	in_len = 254;

	port_printf("api_digest in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	

	ret = api_digest (alg,in_buf,in_len,out_buf,&out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_digest!\n");	
		return ret;
	} 
	port_printf("api_digest output:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");		

	if(memcmp(out_buf,refer_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_digest comparison!\n");	
		return 0xFFFFFFFF;
	}
	
	return SE_SUCCESS;
}



/*************************************************
Function:	  sym_test
Description:  对称算法加解密、MAC计算、验证测试
Input:	      no            
Output:	      no
Return:   	  参见error.h	
Others:	      no	
*************************************************/
/**
* @brief 对称算法加解密、MAC计算、验证MAC示例
* @param no
* @return 参见error.h
* @note no
* @see 函数api_sym_encrypt api_sym_decrypt api_mac api_mac_verify 
*/

se_error_t sym_test(void)
{
	se_error_t ret = 0;
	uint8_t init_input[50] = {0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00};
	sym_key_t key={0};
	alg_sym_param_t sym_param={0};
	uint8_t in_buf[CRYPTO_DATA_SIZE]={0};
	uint32_t in_buf_len = 32;
	uint32_t in_len = 0;
	uint8_t out_buf[CRYPTO_DATA_SIZE] = {0};
	uint32_t out_buf_len= 0;
	uint32_t i = 0;
	char s_refer_buf[CRYPTO_DATA_SIZE*2] = {0};
	uint32_t s_refer_buf_len= 0;
	uint8_t refer_buf[CRYPTO_DATA_SIZE] = {0};
	uint32_t refer_buf_len= 0;
	uint8_t mac[16] = {0};
	uint32_t mac_len= 0;


    //设置输入数据，可以根据i值控制输入长度
	while(i<10)
	{
		memcpy(in_buf+i*in_buf_len,init_input,in_buf_len);
		i++;
	} 
	
	
	
	
	/****************************************3des 128 ecb encrypt test*****************************************/
	//3DES-ECB-ENCRYPT-NOPADDING
	//64字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102"
	//208字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C2"
	//240字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C2"
	//496字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C2"
	//3DES-ECB-ENCRYPT-PKCS7
	//62字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06C714B8A2949288284"
	//208字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C27E422822773666C0"
	//490字节"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A47FD1A14E94BA2F63"
	key.alg = ALG_DES128;
	key.id = 0x03;
	sym_param.mode = SYM_MODE_ECB;
	sym_param.padding_type = PADDING_PKCS7;//PADDING_NOPADDING;//PADDING_PKCS7
	in_len =208;
	port_printf("api_sym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
		port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		
	ret = api_sym_encrypt (&key, &sym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_encrypt!\n");
		return ret;
	} 
	port_printf("api_sym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	//ECB
	strcpy(s_refer_buf,"CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C267B6CFE83D2DA06CAB1B04EDC2B88102CD72DFC6E6D040A4E6820CE8391FD1C27E422822773666C0");
	s_refer_buf_len = 216*2;//216*2;//496*2
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	if(memcmp(out_buf,refer_buf,out_buf_len)!=0)
	{
		return 0xFFFFFFFF;
	}
	
	/****************************************3des 128 ecb decrypt test*****************************************/
	
	port_printf("api_sym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_decrypt (&key, &sym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_decrypt!\n");
		return ret;
	} 
	
	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_decrypt comparison!\n");
		return 0xFFFFFFFF;
	}
	
	/****************************************aes 128 cbc encrypt test*****************************************/		
	
	//CBC
	//3DES-CBC-ENCRYPT-NOPADDING
	//64字节"CD72DFC6E6D040A481D6BDEDB6EA5CCCEEC82193B68E9221D8C1CD7C5C02026CD530F77ABAD800083BF9A9634108233DC1A4B86491BD9A4B5DAD9C2ABFE1DCE5"
	//224字节"CD72DFC6E6D040A481D6BDEDB6EA5CCCEEC82193B68E9221D8C1CD7C5C02026CD530F77ABAD800083BF9A9634108233DC1A4B86491BD9A4B5DAD9C2ABFE1DCE5A5953E8EAD1F2B77ED1F88C54FDB112075295AFF7CE59DE36A2572AE7A6044367B6367477423AF60C53C5F1B9A78428C107D5A715492EFB6989F341D7C3B9107B9D4CBA878CFC62E2F7D264BA792B720AA27478882FDF7F1D0C532D8FABEA9D0244E1CE5464942E9B4C4234B35888DFE00603CC0AE5884A08B6636A9783B028018DDBC3EBAFE780D9747DA0DED23BFF441960809731FA322E50C9F4B50EBF59A"
	//240字节"CD72DFC6E6D040A481D6BDEDB6EA5CCCEEC82193B68E9221D8C1CD7C5C02026CD530F77ABAD800083BF9A9634108233DC1A4B86491BD9A4B5DAD9C2ABFE1DCE5A5953E8EAD1F2B77ED1F88C54FDB112075295AFF7CE59DE36A2572AE7A6044367B6367477423AF60C53C5F1B9A78428C107D5A715492EFB6989F341D7C3B9107B9D4CBA878CFC62E2F7D264BA792B720AA27478882FDF7F1D0C532D8FABEA9D0244E1CE5464942E9B4C4234B35888DFE00603CC0AE5884A08B6636A9783B028018DDBC3EBAFE780D9747DA0DED23BFF441960809731FA322E50C9F4B50EBF59ABB44A9B9A2863BC358F1B68EFD71B3D4"
	//496字节"CD72DFC6E6D040A481D6BDEDB6EA5CCCEEC82193B68E9221D8C1CD7C5C02026CD530F77ABAD800083BF9A9634108233DC1A4B86491BD9A4B5DAD9C2ABFE1DCE5A5953E8EAD1F2B77ED1F88C54FDB112075295AFF7CE59DE36A2572AE7A6044367B6367477423AF60C53C5F1B9A78428C107D5A715492EFB6989F341D7C3B9107B9D4CBA878CFC62E2F7D264BA792B720AA27478882FDF7F1D0C532D8FABEA9D0244E1CE5464942E9B4C4234B35888DFE00603CC0AE5884A08B6636A9783B028018DDBC3EBAFE780D9747DA0DED23BFF441960809731FA322E50C9F4B50EBF59ABB44A9B9A2863BC358F1B68EFD71B3D4F8F771DC5BAC0087F1303D81F1FC0643D876F13A011E4D8A17E64DE07E067988C1FF33FD5C30F7B049A077D44818B97A4A5EC8CDE030921CBD95A33513678A43FB04210C680E1A73F2623CBF7BC9B1DB3495703AC01ABBB024C75D6C0973D8AB84328218C0F06E3D8E724D16C3DE2AF87D98F34FC1DEA0EB804E90B04B9D43357C182070CE49A87A2C64C49FC234116DAD3BD100E5CB0F1F94F50E3A8427406DA014A01D776A31377557A591477B47CA58E58D4715AE493F826A4505755CC819027A4C131BB02E2F8D66DB1B40D573051D5BBBE86A2DDDA585875E2AB30E5210D343F2DA79EDB2E46C2C056843B4FBA2961E5F6956C52805599316333D58F143"
	
	//AES-CBC-ENCRYPT-PKCS7
	//55字节"9C82B25762C618979308B22243B86E983E92C433A6080E380499B1212B24B84A077F66BC1DD952D1AD74290DB31676E4C1B03FDF70E7FACFE4308D837A9953B5"
	//176字节"9C82B25762C618979308B22243B86E983E92C433A6080E380499B1212B24B84A077F66BC1DD952D1AD74290DB31676E4597832E859D663C3328B7D2B1D665EDEBB0B4E92B1BACAE99CF2BD8C01F07D06184F0E7E084677C3538A2CF973EF0F5708182CAA7F41BCD145390BAD7B3AC18C764DA9D5CE3BF46B75245D2DD835F2335A6A3DFAE0E9DE269A7BB8770800688EC00A360FF5F8C0D88086AFA7F9042B92E56C34402F9CA95B3A2F25D89EA1D2D726A7177ECB5F61FB3D70CB5F3863CA88"
	//250字节"9C82B25762C618979308B22243B86E983E92C433A6080E380499B1212B24B84A077F66BC1DD952D1AD74290DB31676E4597832E859D663C3328B7D2B1D665EDEBB0B4E92B1BACAE99CF2BD8C01F07D06184F0E7E084677C3538A2CF973EF0F5708182CAA7F41BCD145390BAD7B3AC18C764DA9D5CE3BF46B75245D2DD835F2335A6A3DFAE0E9DE269A7BB8770800688EC00A360FF5F8C0D88086AFA7F9042B92E56C34402F9CA95B3A2F25D89EA1D2D718BBB33214B0A65A4EF5C0B1FEE91A53AEDEB0A080E0E43F4D783D841BDF82BF5683E6A203DFBD2EF4F5D3FAB29EB5F313EDDFAFE52D8D4822DE407C7BAF8CF837648EA9FBDC494466D633ABE8522596"
	key.alg = ALG_AES128;
	key.id = 0x04;
	sym_param.mode = SYM_MODE_CBC;
	memset(sym_param.iv,0x00,16);
	sym_param.iv_len = 16;
	sym_param.padding_type = PADDING_PKCS7;//PADDING_NOPADDING;//PADDING_PKCS7
	in_len = 250;
	
	port_printf("api_sym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_encrypt (&key, &sym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_encrypt!\n");
		return ret;
	} 
	
	port_printf("api_sym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	strcpy(s_refer_buf,"9C82B25762C618979308B22243B86E983E92C433A6080E380499B1212B24B84A077F66BC1DD952D1AD74290DB31676E4597832E859D663C3328B7D2B1D665EDEBB0B4E92B1BACAE99CF2BD8C01F07D06184F0E7E084677C3538A2CF973EF0F5708182CAA7F41BCD145390BAD7B3AC18C764DA9D5CE3BF46B75245D2DD835F2335A6A3DFAE0E9DE269A7BB8770800688EC00A360FF5F8C0D88086AFA7F9042B92E56C34402F9CA95B3A2F25D89EA1D2D718BBB33214B0A65A4EF5C0B1FEE91A53AEDEB0A080E0E43F4D783D841BDF82BF5683E6A203DFBD2EF4F5D3FAB29EB5F313EDDFAFE52D8D4822DE407C7BAF8CF837648EA9FBDC494466D633ABE8522596");
	s_refer_buf_len = 256*2;//64*2//192*2//256*2
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	if(memcmp(out_buf,refer_buf,out_buf_len)!=0)
	{
		return 0xFFFFFFFF;
	}

	/****************************************3des 128 cbc decrypt test*****************************************/
	port_printf("api_sym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_decrypt (&key, &sym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_decrypt!\n");
		return ret;
	} 
	
	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_decrypt comparison!\n");
		return 0xFFFFFFFF;
	}
	
	
	

	/****************************************3des 128 mac test*****************************************/
	//3DES-PADDING_NOPADDING
	//272字节"17E64DE07E067988"
	//64字节"5DAD9C2ABFE1DCE5"
	//208字节"9747DA0DED23BFF4"
	//480字节"6C2C056843B4FBA2"

	key.alg = ALG_DES128;
	key.id = 0x03;
	memset(sym_param.iv,0x00,8);
	sym_param.iv_len = 8;
	sym_param.padding_type = PADDING_NOPADDING;
	strcpy(s_refer_buf,"5DAD9C2ABFE1DCE5");
	s_refer_buf_len = 16;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	
	in_len = 64;
	port_printf("api_mac in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		

	ret = api_mac (&key, &sym_param, in_buf, in_len, mac, &mac_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_mac!\n");
		return ret;
	} 
	
	port_printf("api_mac mac:\n");
	for(i = 0;i<mac_len;i++)
	{
			port_printf("%02x",mac[i]);
	}
	port_printf("\n");	

	if(memcmp(mac,refer_buf,mac_len)!=0)
	{
		LOGE("failed to api_mac comparison!\n");
		return 0xFFFFFFFF;
	}
	
	/****************************************3des 128 verify mac test*****************************************/	
	port_printf("api_mac_verify refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_mac_verify (&key, &sym_param, in_buf, in_len, refer_buf, refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_mac_verify!\n");
		return ret;
	}

/****************************************AES 128 MAC test*****************************************/
	//AES
	//64字节-NOPADDING："597832E859D663C3328B7D2B1D665EDE"
	//224字节-M1："15CBBB686D11EBB27C71FFA699439AF0"
	//240字节-NOPADDING："13EDDFAFE52D8D4822DE407C7BAF8CF8"
	//493字节-M2："41CC9079D35F387219FF30E23F4B453D"
	
	key.alg = ALG_AES128;
	key.id = 0x04;
	memset(sym_param.iv,0x00,16);
	sym_param.iv_len = 16;
	sym_param.padding_type = PADDING_NOPADDING;
	in_len = 64;
	port_printf("api_mac in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_mac (&key, &sym_param, in_buf, in_len, mac, &mac_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_mac!\n");
		return ret;
	} 
	port_printf("api_mac mac:\n");
	for(i = 0;i<mac_len;i++)
	{
			port_printf("%02x",mac[i]);
	}
	port_printf("\n");		
	
	strcpy(s_refer_buf,"597832E859D663C3328B7D2B1D665EDE");
	s_refer_buf_len = 32;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	if(memcmp(mac,refer_buf,mac_len)!=0)
	{
		LOGE("failed to api_mac comparison!\n");
		return 0xFFFFFFFF;
	}
	
	


	 
	



	/****************************************SM4 ecb encrypt test*****************************************/		
	//64字节："A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A83F90CC9F35CAC4DAF66BFA071C4182"
	strcpy(s_refer_buf,"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A83F90CC9F35CAC4DAF66BFA071C4182");
	s_refer_buf_len = 160;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;	
	
	key.alg = ALG_SM4;
	key.id = 0x06;
	sym_param.mode = SYM_MODE_ECB;
	sym_param.padding_type = PADDING_PKCS7;
	in_len = 64;
	port_printf("api_sym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_encrypt (&key, &sym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_encrypt!\n");
		return ret;
	} 
	
	port_printf("api_sym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");		
	
	if(memcmp(out_buf,refer_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_encrypt comparison!\n");
		return 0xFFFFFFFF;
	}
	
	
	/****************************************SM4 ecb decrypt test*****************************************/

	//ECB
	//64字节"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33B6E4B2E664DD57F630345B9B4DF25098"
	//224字节"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33"
	//256字节"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33A83F90CC9F35CAC4DAF66BFA071C4182"
	//496字节"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A83F90CC9F35CAC4DAF66BFA071C4182"
	strcpy(s_refer_buf,"A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33AE3255D07C1F1330EF16E19F2F639A33A90E532A9EB747CC677BE4412A39EF33A83F90CC9F35CAC4DAF66BFA071C4182");
	s_refer_buf_len = 512;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;


	key.alg = ALG_SM4;
	key.id = 0x06;
	sym_param.mode = SYM_MODE_ECB;
	sym_param.padding_type = PADDING_PKCS7;
	
	
	port_printf("api_sym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_decrypt (&key, &sym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_decrypt!\n");
		return ret;
	} 

	port_printf("api_sym_decrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_decrypt comparison!\n");
		return 0xFFFFFFFF;
	}

	
	/****************************************SM4 cbc encrypt test*****************************************/
	//256字节"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A51D5C0CB5241603E6BB169DC7BA1B73EEC2ECCECC5FFE85A43E41B2CE3555E409"
	
	sym_param.mode = SYM_MODE_CBC;
	memset(sym_param.iv,0x00,16);
	sym_param.iv_len = 16;
	strcpy(s_refer_buf,"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A51D5C0CB5241603E6BB169DC7BA1B73EEC2ECCECC5FFE85A43E41B2CE3555E409");
	s_refer_buf_len = 512;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	sym_param.padding_type = PADDING_NOPADDING;
	in_len = 256;
	port_printf("api_sym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	ret = api_sym_encrypt (&key, &sym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_encrypt!\n");
		return ret;
	} 
	
	port_printf("api_sym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	if(memcmp(out_buf,refer_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_encrypt comparison!\n");
		return 0xFFFFFFFF;
	}
	
	
	
	
	/****************************************SM4 cbc decrypt test*****************************************/
	//CBC
	//64字节"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E"
	//224字节"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A5"
	//240字节"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A51D5C0CB5241603E6BB169DC7BA1B73EE"
	//496字节"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A51D5C0CB5241603E6BB169DC7BA1B73EEC2ECCECC5FFE85A43E41B2CE3555E409943376B0A77826CDA1124EDE4CB21BFA5829BA98D1330D6CD2B72F446F0CA1F011D8E4EE1D4B4499281A09B8824A022D0A84A619707F2393F3D427D93ACA2B229D0739048500D7DE1183B8851D12E2A9F162B433AF56C4921550AB89803A2990A59A25E71A1BEBDB32061099CFFFD3C7E2BF2F5BB72CB81DF5FCFB4CE392F8CA1F16EE119AC13708D9BA8EE47443A4ACECC725B8AF50B7D2AE772CD2FDCC376D5D4750629861F35F4E1F6310385D366F1FA9CBD86EBCBC983B0B33C205C4C8EA7BC84D89B4817BCC8BDCF6E4F5115EB07C97BAF7E8B616BABEFEDDCA4A0DE12A4AE6AC3F8F14CC6A455FF17EC0DA27E2"
	sym_param.mode = SYM_MODE_CBC;
	memset(sym_param.iv,0x00,16);
	sym_param.iv_len = 16;
	strcpy(s_refer_buf,"A90E532A9EB747CC677BE4412A39EF33C54D48FA4358F1C23504D52554D262CB9407A7337576D206702386E343CD20CFDE8E97CB6BD6612AB6C2BB148AA88D1E9F9241F9ED27D64AA8D1D5AECCA8FB31F907E8344EE190B3AC2A16B8D6FA6AB5F8E80AC995F44FACBE9C1847258F0AFE4355896B04071F798D62E43F7189291C7638F6CB84AB94FB465FF4E959C72A8AD6ABE0D365DA8187C95ABCCC6701FC4286AEE7FC1CD6EA1083867D0B4E64821E1FCCB19485DF35FD205AF3FE9A1D27515CBC306AC4B538FA5F4DFDFDC48E0D763F8E6FC351DFE72C32F3C3A90E9CE1A51D5C0CB5241603E6BB169DC7BA1B73EE");
	s_refer_buf_len = 480;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	sym_param.padding_type = PADDING_NOPADDING;
	
	port_printf("api_sym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_sym_decrypt (&key, &sym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_sym_decrypt!\n");
		return ret;
	} 
	port_printf("api_sym_decrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_sym_decrypt comparison!\n");
		return 0xFFFFFFFF;
	}
	
	
	/****************************************SM4验证 MAC test*****************************************/

	key.alg = ALG_SM4;
	key.id = 0x06;
	memset(sym_param.iv,0x00,16);
	sym_param.iv_len = 16;
	sym_param.padding_type = PADDING_ISO9797_M1;
	strcpy(s_refer_buf,"96326445BD7C67099477C0CDA62B8340");
	s_refer_buf_len = 32;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
  in_len = 208;
	
	port_printf("api_mac_verify in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	port_printf("api_mac_verify refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");		
		
	
	ret = api_mac_verify (&key, &sym_param, in_buf, in_len, refer_buf, refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_mac_verify!\n");
		return ret;
	} 



	
	return SE_SUCCESS;

}




/**
* @brief 非对称算法加解密、签名验签示例
* @param no
* @return 参见error.h
* @note no
* @see 函数api_asym_encrypt api_asym_decrypt api_asym_sign api_asym_verify
*/
se_error_t asym_test(void)
{
	
	
	//SM2、ECC、RSA、SM9计算示例
	
	se_error_t ret = SE_SUCCESS;
	uint8_t init_input[50] = {0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0x00};
	pub_key_t pub_key={0};
	pri_key_t pri_key={0};
	alg_asym_param_t asym_param={0};
	uint8_t in_buf[CRYPTO_DATA_SIZE]={0};
	uint32_t in_buf_len = 32;
	uint32_t in_len = 0;
	uint8_t out_buf[CRYPTO_DATA_SIZE] = {0};
	uint32_t out_buf_len= 0;
	uint32_t i = 0;
	char s_refer_buf[CRYPTO_DATA_SIZE*2] = {0};
	uint32_t s_refer_buf_len= 0;
	uint8_t refer_buf[CRYPTO_DATA_SIZE] = {0};
	uint32_t refer_buf_len= 0;
	user_id_t uid = {0};
	//pub_key_t pub_key = {0};
	uint8_t za[32]  = {0};
  uint8_t input_za[CRYPTO_DATA_SIZE]  = {0};
    //设置输入数据，可以根据i值控制输入长度
	while(i<20)
	{
		memcpy(in_buf+i*in_buf_len,init_input,in_buf_len);
		i++;
	}
	

	



	/****************************************SM2 encrypt test*****************************************/
    //SM2-ENCRYPT
	pub_key.alg = ALG_SM2;
	pub_key.id = 0x0F;
	in_len  = 250;
	port_printf("api_asym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_asym_encrypt (&pub_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_encrypt!\n");
		return ret;
	} 
	
	port_printf("api_asym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	//64字节："9FEC3017F82513E99DF75BFB8330EC1795BEAB2E4F50D8D5056FD6E77F90C3080D60BB57C91FC293E3EFB958057A6195BA061ADC7B224A4D59D9460CDE091F9FD4CDAD021507B1ADFF13CF374E70F21A540930E36D0E62B6D0F607441ED0E70D27C6C1ECB7E20BD96FE253AC436F27D3D6C9C71F248EC3EAEC5B0B3EB979E0FD6943C000689BE0C4EB859A6FE72FF9CFFF6D15ACDDFBA19F3E195399F094E805"
	//250字节："3AEC3654B9D284D922AF73203E4CD9C5AA8483D6F0B4D16A29971FF516C8F13D91B826D2B7186FB2E5223900A93AA61CCFF5EE1401AE6027653A0F81168B91B1FF896CEF3059E898117E1091B0E27CD6E63CD9BF04455079EE327B4009476527786589E987E170983D19B2C063038240B474AD10A3AB0891EF39B9450241AB95B470200CCD5A8A52C6B5BCBA09B9D44550E92A1367F3A68C8C69A2C659E32BF3C5E61BC3033A064E8F7FF08318F9E5B9B134831684A2DF3A10CECA5F7E303B1C70DD78A180EDFF8A9E162290B8FB0D3CD482C38FF7230B721AB4B4D9B50345F3B03C8322C01BF3383E561BF2C6A027DE94F1B3E816163DFDF579E4FE94E26FF67954B4EECFE928795737F883F8C399EA31665D289837E2370B3347F94FC428FE52FE63789F819378A737EED088F45F4CCA9FE176EF39DEF1510A53BAA68835AF0F8DD514DD98E412DDB13066DAD6BB9FC9B53E858D38E87CC7F5"
	//256字节："3AEC3654B9D284D922AF73203E4CD9C5AA8483D6F0B4D16A29971FF516C8F13D91B826D2B7186FB2E5223900A93AA61CCFF5EE1401AE6027653A0F81168B91B1FF896CEF3059E898117E1091B0E27CD6E63CD9BF04455079EE327B4009476527786589E987E170983D19B2C063038240B474AD10A3AB0891EF39B9450241AB95B470200CCD5A8A52C6B5BCBA09B9D44550E92A1367F3A68C8C69A2C659E32BF3C5E61BC3033A064E8F7FF08318F9E5B9B134831684A2DF3A10CECA5F7E303B1C70DD78A180EDFF8A9E162290B8FB0D3CD482C38FF7230B721AB4B4D9B50345F3B03C8322C01BF3383E561BF2C6A027DE94F1B3E816163DFDF579E4FE94E26FF67954B4EECFE928795737F883F8C399EA31665D289837E2370B3347F94FC428FE52FE63789F819378A737EED088F45F4CCA9FE176EF39DEF1510A53BAA68835AF0F8DD514DD98E412DDB13066DAD6BB9FC9B53E858D38E87CC7F5"
	strcpy(s_refer_buf,"3AEC3654B9D284D922AF73203E4CD9C5AA8483D6F0B4D16A29971FF516C8F13D91B826D2B7186FB2E5223900A93AA61CCFF5EE1401AE6027653A0F81168B91B1FF896CEF3059E898117E1091B0E27CD6E63CD9BF04455079EE327B4009476527786589E987E170983D19B2C063038240B474AD10A3AB0891EF39B9450241AB95B470200CCD5A8A52C6B5BCBA09B9D44550E92A1367F3A68C8C69A2C659E32BF3C5E61BC3033A064E8F7FF08318F9E5B9B134831684A2DF3A10CECA5F7E303B1C70DD78A180EDFF8A9E162290B8FB0D3CD482C38FF7230B721AB4B4D9B50345F3B03C8322C01BF3383E561BF2C6A027DE94F1B3E816163DFDF579E4FE94E26FF67954B4EECFE928795737F883F8C399EA31665D289837E2370B3347F94FC428FE52FE63789F819378A737EED088F45F4CCA9FE176EF39DEF1510A53BAA68835AF0F8DD514DD98E412DDB13066DAD6BB9FC9B53E858D38E87CC7F5");
	s_refer_buf_len = 692;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
  pri_key.alg = ALG_SM2;
	pri_key.id = 0x0F;
	
	port_printf("api_asym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		
	ret = api_asym_decrypt (&pri_key, &asym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_decrypt!\n");
		return ret;
	} 
	
	port_printf("api_asym_decrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	

	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_asym_decrypt comparison!\n");
		return 0xFFFFFFFF;
	}		
	
	
		
	
	
	/****************************************SM2 get za test*****************************************/
	//设置AID
	strcpy(s_refer_buf,"31323334353637383132333435363738");
	s_refer_buf_len = 32;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	uid.val_len = refer_buf_len;
	memcpy(uid.val,refer_buf,uid.val_len);
	//设置SM2公钥
	strcpy(s_refer_buf,"160E12897DF4EDB61DD812FEB96748FBD3CCF4FFE26AA6F6DB9540AF49C942324A7DAD08BB9A459531694BEB20AA489D6649975E1BFCF8C4741B78B4B223007F");
	s_refer_buf_len = 128;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	pub_key.val_len = refer_buf_len;
	memcpy(pub_key.val,refer_buf,pub_key.val_len);
	
	ret = api_sm2_get_za (&uid,&pub_key,za);

	port_printf("api_sm2_get_za za:\n");
	for(i = 0;i<32;i++)
	{
			port_printf("%02x",za[i]);
	}
	port_printf("\n");		
	
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_decrypt comparison!\n");
		return ret;
	} 
	
	/****************************************SM2 sign test(带ZA)*****************************************/
	//SM2-SIGN
	pri_key.alg = ALG_SM2;
	pri_key.id = 0x0F;
	asym_param.hash_type = ALG_SM3;
	in_len = 64;
	
	
	//带ZA的签名，需要将ZA和源数据进行拼接后传入
	memcpy(input_za,za,32);
	memcpy(input_za+32,in_buf,in_len);
	
	ret = api_asym_sign (&pri_key, &asym_param, input_za, in_len+32, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_sign!\n");
		return ret;
	} 
	port_printf("api_asym_sign(with za) out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");		
	
	//64字节："52CEAA19829C8B345FE7E794485C8E65D097ED2A7908A704939151BB6B53A33D869C7188A2BF6B0039E8040F4DBAE06288D9DD049391CE4F3B8212F735879C9C"
	strcpy(s_refer_buf,"52CEAA19829C8B345FE7E794485C8E65D097ED2A7908A704939151BB6B53A33D869C7188A2BF6B0039E8040F4DBAE06288D9DD049391CE4F3B8212F735879C9C");
	s_refer_buf_len = 128;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	pub_key.id = 0x0F;
	ret = api_asym_verify (&pub_key, &asym_param, input_za, in_len+32, refer_buf, &refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_verify!\n");
		return ret;
	}	
	
	
	

	/****************************************SM2 sign test(不带ZA)*****************************************/
	//SM2-SIGN
	pri_key.alg = ALG_SM2;
	pri_key.id = 0x0F;
	asym_param.hash_type = ALG_SM3;
	in_len = 64;
	
	port_printf("api_asym_sign in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	

	ret = api_asym_sign (&pri_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_sign!\n");
		return ret;
	} 
	
	port_printf("api_asym_sign out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	//64字节："21F2814CFE28A4F65BFF9A5CE0C6475AE4D9EAB0B9B419912C019EECE1ACDC0BA9D80426C918B63F7628EF103C176986AFB5A74E72EB062B0A3C7655DF6E402B"
	//250字节："386BDC46FBB0E66C91E364BD7C8DA49F11A7A66041EC01A6E59FB5ED02CBBC5BBA78A4C66D7A4A968B4D2DDB45507700448DC891763AC042ED2422DEA55EFCC7"
	//256字节："FF17694193A274D33ED2CB7131B8F1E41EE7B0D2AC20196BB30FC59638883CF099919420F711D8889B5B59E9314934AFF6C9235D6ECE2F584E3633438DD99A48"
	//512字节："56F345F266617FC73EE72B5507F2D852D848FF20B3A724A1CBA57C0E4120A6886B45B0F1D0FD880C3403EA355D6532710602BDD248353CB69D056D0ABBAE6953"
	//255字节："4F4ED3CA4DF5632CAD1259BA9B87940B929DD5BCE15F060E65D46E90967FBE7C7D0285BCF0202FADCCC09A90E4DE3FB35B4342C2CDBAE7B77755F42E8BE22518"
	//240字节："DEC62814C35DE37136627312B8B9E30118BAE0DDAB9F5FB894162530274CF5005478B94049856072696BE5D130D74084EC20717BA39C6FAF3940ABC96229DCEC"
	//440字节："1021DD5B3CAF3F4AEC98F9F8C3EC98C309DA2678119777FA7900212D13D7669053C127FDA4C895AA1D46E075CC2D7242AD1EDCB9F92EB2DCE71E77BB29DB4544"
	//500字节："3B8048BE8F3B5456EE8AD326C1C56CE69DEAEE4C9B806910EC1BF9C1A0E810B4866E9ED1E7395956B54D73155BC00EFA2406F81E51FF2EAEA358CCFD39909318"
	strcpy(s_refer_buf,"21F2814CFE28A4F65BFF9A5CE0C6475AE4D9EAB0B9B419912C019EECE1ACDC0BA9D80426C918B63F7628EF103C176986AFB5A74E72EB062B0A3C7655DF6E402B");
	s_refer_buf_len = 128;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	pub_key.id = 0x0F;
	in_len = 64;
	
	port_printf("api_asym_verify in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	

	port_printf("api_asym_verify refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_asym_verify (&pub_key, &asym_param, in_buf, in_len, refer_buf, &refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_verify!\n");
		return ret;
	}



	/****************************************ECC encrypt test*****************************************/
	//ECC256-ENCRYPT
	pub_key.alg = ALG_ECC256_NIST;
	pub_key.id = 0x09;
	in_len = 250;
	
	port_printf("api_asym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
		port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_asym_encrypt (&pub_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to exter_auth_test!\n");
		return ret;
	} 
	
	port_printf("api_asym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	//64字节："5BC22D2117D5C72F311ABDEDE06BF3A0F283FAA0A520D87A3D9266E4AD798ECCAB561D1954EF98640393456C0769BE6EC7DFE3B3E7AB452F34F4C860DF0F96C516CB6409F2EC4C69281940E2EFB6F898AA0D5125F24A27928AE5DA2C78341209DB9E1F22B42F65314DC393FF2D61397E949BCF33F35AE6601384B52E6BDDB61D0D755304CD1B9EA261B7E4B2393BA8C2C8F41572B917FCC4D9067055A1679F6E"
	//250字节："63C23B15B84C44A758643C92B4725358ACFE45036774B29C1AF3093F150E0F24C3B36EAB8ED5DE54260370F7B2DD817E02CAF56DBABA255099B480DDB72698E98A0E78E60270B34C0034B7D35EA18F19178C07615C592FA5411516D83C20CB27B7C33BAA088D379D4F79C43D55DA62329625FBE72FA86455276BF14523B0E3D8B0DCE2FBE770EE7D7FBA464B2580AAAB4B8E7833B9A44A47880A15D06E3F4E084B4D758DC9D7461C30F5900160DD4C059E2EC643B86F7A0E47DB3D0951FC5172DC76D7F224364B450606A1F305F650083BCDADD14464775E9570AEFCA00A83A46F602EF1E0802EDFA17774DA85693CF66A16A45DDD048773B6C01D88EB096CDD6168548B2756C5A1CB4CC2AB07D704DD83F96C9B078DB8BDB83C3EB1BE57853F18DDD998FE9B619CAA2387430D5453B245F448CBBC39B2DC971A7BDFFAE7B97F258DB3855BCD3D9C7891CF371DA3AF8FCACE9B3EB552451A2826"
	//256字节："55A53AA9E168EC737DD3FD4A93E9CF83498B3CCBD424F895368CC680A11485B259C8EF9D0C206BC68DC2BDDC9249DFA75E5D671F54E48FE4D251E34AA6A25F26635BE40929650B63862DD9855F4A8FDB1CFCCFF577566563CB1704807106559FE2697C5C33EDB604A820389750185EEBE9520D043E1822302049FD1372D28949F4DB26297A07529AF88BC9ED1483F81748A446F5CE4FA25F5A86DA38DB671CA637F0768A80EED6A916198A0073562654AF9EBC077DB926D43918DE092D756EA39C9C67E00ABD654857770D968BA82C24C44EE302948E4A74938FC9A45243EC45664DED73797320A0BE3C283A445DFD4068DCDCB5F1976CE3F625A424A944296887D45D0CBFF4C3476A4C94D42F279F2C6103175D2B02EFDACD628CC9A8929613A762E279E5000725BA07F64C22E5C3F2DB9C42E92AF1D6799BF342064068B23482C18C569B993D6C4D2CE11861422AEFB4A4CA15599FB1090D6682F81816716B"
	//1024字节："706A5A6A5A2EAD5A4C9EDA6216D885EFE25101345CD08A350ABB0AB4C2D22ADF368591ED1B9F15CD7EA24516FB35EB2E06A2019129D8B08DAC8D7FDAF0A1082FC9FF3D39F4FCD2D4068A328B54DA4E5A1031C5800DBB70562003C27944FD6B05A05B8E91D8BCDC66EEE3E1A9CE7BFA6DBF39DDCEA42EA3799D534BB91073DB484FB97D9C7E34679CF9F0CC2E7F6C77D509242E77919695B11553B4EE3F327718D60BF3C6FB9DC8E241301DB7C83BDC7AC097F95C642772DEBAD58DE73B2C6DFAB457A170F807820987142FA9314AE1366DD4F6245BE09936F2F5DFE4EEC48287E103C58DBC582C3A46DB68C98E243FC2FB5ED7521FD5EF453B5587BA14B421FB3492847433483A40E117F9546F4EF2182820CC0B5EDDC20344F537358375F1FBE4B1A0E124D795E9B1FF785C448E5E7DB7C105FF44D5E325B40DA05E3A19E29177FBEFEE679FBE0C50D9105F1AEE81383AF33A5223AA9392954ED631E41EEC01D0B0721B83E0352830FB471DEF8A303848DBC5FB1C6EBCAF456DEAA8243D65B7E116B98053DB974D365BE7C13D1FBE9D20FF54463525BD408791950DD44FFC49FD443A654BAFC92D95BD8D4FCCAA636132233124E5E7BC67BB2EEC1FCF62187D0A18DA87A12A2B140D2D33E9F39BF5A785E5FEEBC48A51CEEF4583985621AD0871A9526CECC245FAC1050B03788F163D5EF0C2DE431001EAA285B40617974D0BAAC272F169321A436982376115FD0644FA5556FF9D6583487F8274291932D716349DAEC455AF6767E95C25D8008E711C68DCA3FB2D5DA49795CD8F4F2364AFACB6896A4DA1A3D1676DC6D7A3B338B34E5B4815D007FE2F1CF3F086E31926590A41344A10DDA59DB102C6C9440C9260FD4FAE426F6AE23AB67E513E6D6538E3C0ADB5A2749D389EF28A8345E62DFE3C04C3C03423105DE9627F47F5AE9FEF8AFA71D8F9A2456B3CDABB4B2A6A6387E29C37FC55C633C65FF30960AAFAD9B1C66B981FA0584E1F456B5F748BE7F3722661A92DB9C2E69D01E03145F17893D9D9379ED7FFFA0441BCAC3CF497BD3CD873B0E60CEC8BCADA642797DADCDCCB4498D8DE85EC3E325BE83DB572EDB279E56B01811D4EED02F72327BA150AFD59676623C879A0CA0B50C7F62A0863C0B65F5072709BA9EF3C6763F44350855960BB74E26C88288871B29EBCF68C2F046FC5C729C9B01CA3F9D1481522B05DC78964965E93F6962E37F5E323FF821548F02903901DDA5EADC8E51990558DF8DE68A9451A40713E1D630017DCA1EA4DB11D42AC5DDF08114BA0DE5C4EB4B73948857876D3CB651C99AA83B2E9B71B08FE009A06E1ADE74CC2CAC264D466D4F322E7C334DAB08B9E955921D220C06292A898DBBFE9FA6EA5DF18C075624597434D421A352C3E83B1793C243B86AD9658F9A4524E6D1ADEFA7F336293F000C02F801EF90D3773EEB195EBBE6E8BAEFC26E5609C0DD634DD71DEFFE7676E87AC45F949DEEB32AE5A5809EA7B37AFB3D4C084AAD2D4EC62171CF2FF9E1C4CD0E9E2A5383708663819676A48DEB68BE3BA56168CE2811D9D37116E94D317D269AB32CF42E6575E"
	strcpy(s_refer_buf,"63C23B15B84C44A758643C92B4725358ACFE45036774B29C1AF3093F150E0F24C3B36EAB8ED5DE54260370F7B2DD817E02CAF56DBABA255099B480DDB72698E98A0E78E60270B34C0034B7D35EA18F19178C07615C592FA5411516D83C20CB27B7C33BAA088D379D4F79C43D55DA62329625FBE72FA86455276BF14523B0E3D8B0DCE2FBE770EE7D7FBA464B2580AAAB4B8E7833B9A44A47880A15D06E3F4E084B4D758DC9D7461C30F5900160DD4C059E2EC643B86F7A0E47DB3D0951FC5172DC76D7F224364B450606A1F305F650083BCDADD14464775E9570AEFCA00A83A46F602EF1E0802EDFA17774DA85693CF66A16A45DDD048773B6C01D88EB096CDD6168548B2756C5A1CB4CC2AB07D704DD83F96C9B078DB8BDB83C3EB1BE57853F18DDD998FE9B619CAA2387430D5453B245F448CBBC39B2DC971A7BDFFAE7B97F258DB3855BCD3D9C7891CF371DA3AF8FCACE9B3EB552451A2826");
	s_refer_buf_len = 692;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
  pri_key.alg = ALG_ECC256_NIST;
	pri_key.id = 0x09;
	
	port_printf("api_asym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_asym_decrypt (&pri_key, &asym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_decrypt!\n");
		return ret;
	} 
	
	port_printf("api_asym_decrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	

	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_asym_decrypt comparison!\n");		
		return 0xFFFFFFFF;
	}
	
	
	/****************************************ECC sign test*****************************************/

	//ECC256-SIGN
	pri_key.alg = ALG_ECC256_NIST;
	pri_key.id = 0x09;
	asym_param.hash_type = ALG_SHA256;
	in_len = 64;
	
	port_printf("api_asym_sign in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_asym_sign (&pri_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_sign!\n");
		return ret;
	} 

	port_printf("api_asym_sign out_buf:\n");
 	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	//64字节："551894243A200E8C43B6A69C8D2CA6B97180B6E3DCA9F1BB661A7720F7E158A804DCC6B7EFCE2AF5E24A79E3CF595CA8C4F7DA48FCA4CE21D011545B50814F27"
	//250字节："A599F2B6F4C060ED8D7F17ECB8E2F140E39E5FE2EBD3E53F7FBE7B4E2DCD8FE3DF8388229848584DE5859F65F028859EA4B7592C622FB4E68C76E615F7F878B7"
	//256字节："FD6264C567FF382101C5D6B56A3D34250408B8516577E8B80B618F30C7ABE89E66CA78CD13B851CCF0CFA90EFFF77A4856ABA24AF9A245FB837963CAD14DEAE4"
	//512字节："2995459C9150441A8BAE1038119CAE4FB36FC6E95831BE294582CD781841AB3EF60B463440A3183A63CD6D6918C05D95AEAA4344834F06ABFCA0E3E522F936C0"
	strcpy(s_refer_buf,"551894243A200E8C43B6A69C8D2CA6B97180B6E3DCA9F1BB661A7720F7E158A804DCC6B7EFCE2AF5E24A79E3CF595CA8C4F7DA48FCA4CE21D011545B50814F27");
	s_refer_buf_len = 128;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	pub_key.id = 0x09;
	
	port_printf("api_asym_verify in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	port_printf("api_asym_verify refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_asym_verify (&pub_key, &asym_param, in_buf, in_len, refer_buf, &refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_verify!\n");
		return ret;
	} 

	
/****************************************RSA encrypt test*****************************************/
	
	//128字节："075DDBB1995011973E0692DAA023C036193320E1333159AEA5CAA12FB40DAF2397E9381E0ACC9BAC26C40F60D71A4716847B60BE510849CBC558F58FF433EE4D37815A83D9029FD3B9AF82047772A8B60AEE21E552DF86C4D9785D252AD8DB47F6C4DE8E67F4DBFA0BC945825BBE04A24E993BEF3863D79A17F6552307B4C3E5"
	//256字节："84A02F1DD1CE9131D2B436874D41B0AD33DAD4CD20C17F22EA1CDBC90772A063EB34E4E1BBB7FEE5E85477765C119B26F2BA1911CFECEC85A5F246094694DF08C9E463A86BC0686EA2458B6AE40A316357421041701E7E187852A1CB68AA8EB502297934F90C5AB5651070EAA1106146E8D1DB6F87ADB407E82297B337D72B798D53B347C50A8C691B527C24171632E5E7A7DCDA94D92D425FBA7540495363C50AA69B6C3E2ACD163EE16B840798AD9E103BF6A6CFCABC13BCB828B0FAD74E47B025874DF3787159798D02FBF6FFB9E3EF6AB9AB9ACC8F80C120E6AE7D8BD50D8822F001EE4B950DF6EFD5BC4EB24381407EB60249385E55D7D80D05F088B896"
	////RSA1024-ENCRYPT
//    pub_key.alg = ALG_RSA1024_CRT ;
//	pub_key.id = 0x0B;
//	in_len = 128-11;
	//RSA2048-ENCRYPT
	pub_key.alg = ALG_RSA2048_CRT ;
	pub_key.id = 0x0D;
	in_len = 256;
	asym_param.padding_type = PADDING_NOPADDING;//PADDING_NOPADDING;//PADDING_PKCS1

	port_printf("api_asym_encrypt in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
		port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_asym_encrypt (&pub_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to exter_auth_test!\n");
		return ret;
	} 
	
	port_printf("api_asym_encrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	
	strcpy(s_refer_buf,"84A02F1DD1CE9131D2B436874D41B0AD33DAD4CD20C17F22EA1CDBC90772A063EB34E4E1BBB7FEE5E85477765C119B26F2BA1911CFECEC85A5F246094694DF08C9E463A86BC0686EA2458B6AE40A316357421041701E7E187852A1CB68AA8EB502297934F90C5AB5651070EAA1106146E8D1DB6F87ADB407E82297B337D72B798D53B347C50A8C691B527C24171632E5E7A7DCDA94D92D425FBA7540495363C50AA69B6C3E2ACD163EE16B840798AD9E103BF6A6CFCABC13BCB828B0FAD74E47B025874DF3787159798D02FBF6FFB9E3EF6AB9AB9ACC8F80C120E6AE7D8BD50D8822F001EE4B950DF6EFD5BC4EB24381407EB60249385E55D7D80D05F088B896");
	s_refer_buf_len = 512;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	//RSA1024-CRT
	//key.id = 0x0C;
	//RSA2048-CRT
  pri_key.alg = ALG_RSA2048_CRT ;
	pri_key.id = 0x0D;

	port_printf("api_asym_decrypt refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
			port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");		
	
	ret = api_asym_decrypt (&pri_key, &asym_param, refer_buf, refer_buf_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_decrypt!\n");
		return ret;
	} 
	
	port_printf("api_asym_decrypt out_buf:\n");
	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	

	if(memcmp(out_buf,in_buf,out_buf_len)!=0)
	{
		LOGE("failed to api_asym_decrypt comparison!\n");		
		return 0xFFFFFFFF;
	}	
	
	/****************************************RSA sign test*****************************************/
	//RSA2048-SIGN
	pri_key.alg = ALG_RSA2048_CRT;
	pri_key.id = 0x0D;
	asym_param.hash_type = ALG_SHA384;
	in_len = 267;


	////RSA1024-SIGN
	//key.alg = ALG_RSA1024_CRT;
	//key.id = 0x0C;
	//asym_param.hash_type = ALG_SHA1;
	//in_len = 80;
	
	port_printf("api_asym_sign in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_asym_sign (&pri_key, &asym_param, in_buf, in_len, out_buf, &out_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_sign!\n");
		return ret;
	} 

	port_printf("api_asym_sign out_buf:\n");
 	for(i = 0;i<out_buf_len;i++)
	{
			port_printf("%02x",out_buf[i]);
	}
	port_printf("\n");	
	//RSA1024-SIGN
	//80字节："1676A2D859CD60166E67F500E90738F45645AF8511F8C31680806E29497736A92BE152476E7A0F8FC250C2BB397C1AAF4015C5FB686AA7B9CE62717F230E518FCB257BA00FA290E0EADE2B9EC69904B855E1F17EC8E94DDC39C277F543CD5970C99E09F713AE91687E798B415BF411014E53622A8114C2BD0595E25CDA10A19C"
	//267字节："19BFA470512C5E38DC5B05D39252CF48119601DF99697C0906D7351F34A22D07331B9083C49803109E3F91BCF63BB5217FFF11C2993AA56290258486A77222D5000D80931D21D1F41E22B9B23B5F35904BDDAC71A2C65B95265FD62470C6F33F7C3D4332CD7DA1E7B9E34D531E109024A6C39E1138B94D91F0756DB1F9FFEDC2DFAFD9C8D26BD12B3DCC6C8F00F0D0FBF4BBA48F8E002BF4004E08C2625FC7B3DCEF4E5A8D91A3841DC6F134A1015A333030E63A5E349274469E9DA64CA063F60DC6CAEABB94BD7074AA01013BFCE38B8157453BE1B66C58074622FA56F67F424EC6C8E6A10563F41B1ACE511B59FB6764E02F86AB1C65DFF2DF4FF3D0CE5935"
	strcpy(s_refer_buf,"19BFA470512C5E38DC5B05D39252CF48119601DF99697C0906D7351F34A22D07331B9083C49803109E3F91BCF63BB5217FFF11C2993AA56290258486A77222D5000D80931D21D1F41E22B9B23B5F35904BDDAC71A2C65B95265FD62470C6F33F7C3D4332CD7DA1E7B9E34D531E109024A6C39E1138B94D91F0756DB1F9FFEDC2DFAFD9C8D26BD12B3DCC6C8F00F0D0FBF4BBA48F8E002BF4004E08C2625FC7B3DCEF4E5A8D91A3841DC6F134A1015A333030E63A5E349274469E9DA64CA063F60DC6CAEABB94BD7074AA01013BFCE38B8157453BE1B66C58074622FA56F67F424EC6C8E6A10563F41B1ACE511B59FB6764E02F86AB1C65DFF2DF4FF3D0CE5935");
	s_refer_buf_len = 512;
	StringToByte(s_refer_buf,refer_buf,s_refer_buf_len);
	refer_buf_len = s_refer_buf_len/2;
	pub_key.id = 0x0D;//0D//0B
	
	port_printf("api_asym_verify in_buf:\n");
	for(i = 0;i<in_len;i++)
	{
			port_printf("%02x",in_buf[i]);
	}
	port_printf("\n");	
	
	port_printf("api_asym_verify refer_buf:\n");
	for(i = 0;i<refer_buf_len;i++)
	{
		port_printf("%02x",refer_buf[i]);
	}
	port_printf("\n");	
	
	ret = api_asym_verify (&pub_key, &asym_param, in_buf, in_len, refer_buf, &refer_buf_len);
	if ( ret != SE_SUCCESS)
	{
		LOGE("failed to api_asym_verify!\n");
		return ret;
	} 
	

	
	return ret;

}


/**
  * @}
  */

/**
  * @}
  */

/**
  * @}
  */


